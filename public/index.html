<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–ú–û–Ñ –ö–Ü–ù–û ‚Äî –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞ –±–∞–∑–∞ —Ñ—ñ–ª—å–º—ñ–≤</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
:root{
  --bg:#0f1115; --card:#161a22; --muted:#9aa4b2; --text:#e6e9ef;
  --brand:#f6c177; --accent:#7aa2f7; --border:rgba(255,255,255,.08);
  --radius:12px; --btn-h:40px; --btn-gap:8px;
  --btn-bg:var(--card); --btn-bdr:var(--border);
  --btn-hover:rgba(122,162,247,.18);
  --danger:rgba(255,110,110,.22);
  --danger-b:rgba(255,110,110,.38);
  --heart:#ff5c7a;
}

*{box-sizing:border-box}
html,body{
  height:100%;min-height:100vh;margin:0;padding:0;
  background:linear-gradient(180deg,#0e1014,#121521);
  background-attachment:fixed;
  font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;
  color:var(--text);
}

/* ===== –®–ê–ü–ö–ê ===== */
header{
  position:sticky;top:0;z-index:10;
  backdrop-filter:blur(8px);
  background:linear-gradient(180deg,rgba(20,22,28,.9),rgba(20,22,28,.65));
  border-bottom:1px solid var(--border);
}
.nav{max-width:1200px;margin:auto;padding:12px 16px;display:flex;gap:12px;align-items:center}
.brand{font-weight:800;font-size:18px;padding:8px 12px;border-radius:12px;background:linear-gradient(90deg,var(--brand),#ffd39f);color:#1b1b1b}
.subtitle{color:#000;font-size:12px;margin-left:6px}

.search{flex:1;display:flex;gap:8px;background:var(--card);border:1px solid var(--border);border-radius:12px;padding:10px 12px}
.search input{flex:1;background:transparent;border:0;color:var(--text)}

/* ===== –Ñ–î–ò–ù–ò–ô –°–¢–ò–õ–¨ –ö–ù–û–ü–û–ö ===== */
.btn{
  display:inline-flex;align-items:center;justify-content:center;gap:8px;
  height:var(--btn-h);padding:0 14px;border-radius:var(--radius);
  border:1px solid var(--btn-bdr);background:var(--btn-bg);color:var(--text);
  font-weight:600;line-height:1;transition:border-color .15s,box-shadow .15s,background .15s,transform .05s;
  box-shadow:inset 0 1px 0 rgba(255,255,255,.03);user-select:none;
}
.btn:hover{border-color:rgba(122,162,247,.45);background:var(--btn-hover)}
.btn:active{transform:translateY(1px)}
.btn.primary{
  background:linear-gradient(90deg,var(--accent),#9fc3ff);
  color:#0c1222;border:0;box-shadow:0 6px 10px rgba(122,162,247,.15)
}
.btn.primary:hover{filter:brightness(.98)}
.btn[data-edt],.btn[data-del]{width:var(--btn-h);padding:0}
.btn[data-del]{border-color:var(--danger-b)}
.btn[data-del]:hover{background:var(--danger)}
.actions,.movie>div:last-child{display:flex;gap:var(--btn-gap);align-items:center}
.heart{
  width:var(--btn-h);height:var(--btn-h);display:grid;place-items:center;
  padding:0;border-radius:var(--radius);border:1px solid var(--btn-bdr);
  background:var(--btn-bg);color:var(--text);
  transition:background .15s,border-color .15s,transform .05s;
}
.heart:hover{background:rgba(255,96,125,.12);border-color:rgba(255,96,125,.35)}
.heart:active{transform:translateY(1px)}
.heart.fav{
  color:var(--heart);border-color:rgba(255,96,125,.45);
  box-shadow:inset 0 0 0 1px rgba(255,96,125,.25);
  background:rgba(255,96,125,.1);
}

/* ===== –ö–û–ù–¢–ï–ô–ù–ï–† ===== */
.container{max-width:1200px;margin:20px auto;padding:0 16px}
.summary{color:var(--muted);margin:8px 0 16px}

/* ===== –î–í–Ü –í–ï–†–•–ù–Ü –ö–û–õ–û–ù–ö–ò ===== */
.cols{
  display:grid;grid-template-columns:1fr 1fr;gap:20px;align-items:start;
}
@media(max-width:900px){.cols{grid-template-columns:1fr}}
.cols>section{
  display:flex;flex-direction:column;
  height:70vh;min-height:520px;
}
h2{margin:0 0 8px}
.sub{color:var(--muted);font-size:13px;margin-bottom:10px}
.list{
  flex:1;overflow:auto;padding-right:6px;
  border:1px solid var(--border);border-radius:12px;
  background:rgba(255,255,255,.02);
}

/* ===== –ö–ê–†–¢–ö–ò ===== */
.movie{display:grid;grid-template-columns:auto 1fr auto;gap:12px;align-items:start;padding:12px;border-bottom:1px solid var(--border)}
.movie:last-child{border-bottom:none}
.movie.watched{box-shadow:0 0 0 1px rgba(246,193,119,.25) inset}
.poster{width:62px;aspect-ratio:2/3;border-radius:8px;object-fit:cover;background:#0c0f16;border:1px solid rgba(255,255,255,.12)}
.title{font-weight:700}
.meta{font-size:12px;color:var(--muted)}
.stars{font-size:16px;letter-spacing:1px;cursor:pointer}
.chip{display:inline-flex;gap:6px;align-items:center;padding:4px 8px;border-radius:999px;font-size:12px;background:rgba(122,162,247,.15);border:1px solid rgba(122,162,247,.35);margin-top:6px}
.empty{color:var(--muted);border:1px dashed var(--border);border-radius:12px;padding:14px;text-align:center;margin:10px}

/* ===== –£–õ–Æ–ë–õ–ï–ù–Ü –§–Ü–õ–¨–ú–ò ===== */
.recent{margin-top:28px}
details{background:rgba(255,255,255,.03);border:1px solid var(--border);border-radius:12px;padding:10px 12px}
summary{cursor:pointer;font-weight:600}

/* ===== –ú–û–î–ê–õ–ö–ò –Ü –¢–û–°–¢ ===== */
.backdrop{position:fixed;inset:0;display:none;place-items:center;background:rgba(0,0,0,.55);backdrop-filter:blur(6px);z-index:50}
.backdrop.show{display:grid}
.modal{width:min(560px,92vw);background:#151922;border:1px solid var(--border);border-radius:16px;padding:16px}
.grid{display:grid;gap:10px}
.grid-2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
input,textarea{width:100%;padding:10px 12px;border-radius:10px;border:1px solid var(--border);background:rgba(255,255,255,.02);color:var(--text)}
label{font-size:13px;color:var(--muted)}
.section-h3{margin:18px 0 8px}
.toast{position:fixed;bottom:16px;left:50%;transform:translateX(-50%);background:#1a2230;border:1px solid var(--border);padding:10px 14px;border-radius:10px;display:none}
.toast.show{display:block}
</style>
</head>
<body>
<header>
  <div class="nav">
    <div class="brand">–ú–û–Ñ –ö–Ü–ù–û <span class="subtitle">–ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞ –±–∞–∑–∞ —Ñ—ñ–ª—å–º—ñ–≤</span></div>
    <div class="search"><span>üîé</span><input id="q" placeholder="–ü–æ—à—É–∫ —É –Ω–∞–∑–≤—ñ/–∂–∞–Ω—Ä—ñ/—Ä–æ—Ü—ñ..." /></div>
    <button class="btn primary" id="addBtn">+ –î–æ–¥–∞—Ç–∏</button>
  </div>
</header>

<main class="container">
  <div class="summary" id="summary">üéû –£ –ø–ª–∞–Ω–∞—Ö: 0 | ‚úÖ –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–æ: 0</div>
  <div class="cols">
    <section>
      <h2>üé¨ –•–æ—á—É –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏</h2>
      <div class="sub">–§—ñ–ª—å–º–∏, —è–∫—ñ –ø–ª–∞–Ω—É—î—à –ø–æ–¥–∏–≤–∏—Ç–∏—Å—å</div>
      <div id="todo" class="list"></div>
    </section>
    <section>
      <h2>‚úÖ –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–æ</h2>
      <div class="sub">–§—ñ–ª—å–º–∏, —è–∫—ñ —Ç–∏ –≤–∂–µ –ø–æ–¥–∏–≤–∏–≤—Å—è</div>
      <div id="done" class="list"></div>
    </section>
  </div>

  <section class="recent">
    <details id="favBox" open>
      <summary>üåü –£–ª—é–±–ª–µ–Ω—ñ —Ñ—ñ–ª—å–º–∏</summary>
      <div id="favs" class="list" style="margin-top:10px; max-height:40vh;"></div>
    </details>
  </section>

  <section>
    <h3 class="section-h3" id="tmdbTitle" style="display:none">üîé –ó–Ω–∞–π–¥–µ–Ω–æ —É TMDB</h3>
    <div id="tmdbResults" class="list" style="display:none"></div>
  </section>
</main>

<div class="backdrop" id="modal">
  <div class="modal">
    <h3 id="mTitle">–î–æ–¥–∞—Ç–∏ —Ñ—ñ–ª—å–º</h3>
    <div class="grid">
      <div class="grid-2">
        <div><label>–ù–∞–∑–≤–∞</label><input id="fTitle" /></div>
        <div><label>–†—ñ–∫</label><input id="fYear" type="number" min="1888" max="2100" /></div>
      </div>
      <div class="grid-2">
        <div><label>–ñ–∞–Ω—Ä</label><input id="fGenre" placeholder="–§–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞, –î—Ä–∞–º–∞..." /></div>
        <div><label>–û—Ü—ñ–Ω–∫–∞ (0‚Äì5)</label><input id="fRating" type="number" min="0" max="5" value="0" /></div>
      </div>
      <div class="grid-2">
        <div><label>Poster URL (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)</label><input id="fPoster" placeholder="https://..." /></div>
        <div style="display:flex;gap:8px;align-items:center;margin-top:20px">
          <input id="fWatched" type="checkbox" /><label for="fWatched">–ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–æ</label>
        </div>
      </div>
      <div><label>–ö–æ–º–µ–Ω—Ç–∞—Ä</label><textarea id="fComment" placeholder="–í—Ä–∞–∂–µ–Ω–Ω—è..."></textarea></div>
      <!-- part b -->
      <div><label>–†–µ–∂–∏—Å–µ—Ä</label><input id="fDirector" placeholder="–†–µ–∂–∏—Å–µ—Ä" /></div>
      <div><label>–î–∞—Ç–∞ –≤–∏—Ö–æ–¥—É</label><input id="fReleaseDate" type="date" /></div>
      
      <div style="display:flex;gap:8px;justify-content:flex-end">
        <button class="btn" id="cancel">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
        <button class="btn primary" id="save">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
      </div>
    </div>
  </div>
</div>

<div class="backdrop" id="mini">
  <div class="modal" style="width:min(420px,92vw)">
    <h3>–ü–æ–∑–Ω–∞—á–∏—Ç–∏ —è–∫ –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç–æ</h3>
    <div class="grid">
      <div><label>–û—Ü—ñ–Ω–∫–∞ (0‚Äì5)</label><input id="mwRating" type="number" min="0" max="5" value="5"/></div>
      <div><label>–ö–æ–º–µ–Ω—Ç–∞—Ä (–æ–ø—Ü—ñ–π–Ω–æ)</label><textarea id="mwComment" placeholder="–ö–æ—Ä–æ—Ç–∫–æ –ø—Ä–æ –≤—Ä–∞–∂–µ–Ω–Ω—è..."></textarea></div>
      <div style="display:flex;gap:8px;justify-content:flex-end">
        <button class="btn" id="mwCancel">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
        <button class="btn primary" id="mwOk">–ì–æ—Ç–æ–≤–æ</button>
      </div>
    </div>
  </div>
</div>

<div class="toast" id="toast">–ó–±–µ—Ä–µ–∂–µ–Ω–æ</div>

<script>
const API = '/api/movies';
const $ = s=>document.querySelector(s);
const todo = $('#todo'), done = $('#done'), favs = $('#favs');
let editing = null;
let markTarget = null;
const placeholder = 'https://placehold.co/200x300?text=%F0%9F%8E%AC';

function toast(msg){ const t=$('#toast'); t.textContent=msg; t.classList.add('show'); setTimeout(()=>t.classList.remove('show'),1400); }
function starString(n){ return '‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ'.slice(0,n) + '‚òÜ‚òÜ‚òÜ‚òÜ‚òÜ'.slice(0,5-n); }
async function fetchJSON(url,{method='GET',body}={}) {
  const r = await fetch(url, {method, headers: body? {'Content-Type':'application/json'}:undefined, body});
  if (r.status===204) return null;
  return r.json();
}

function openModal(m=null){
  editing = m;
  $('#mTitle').textContent = m ? '–†–µ–¥–∞–≥—É–≤–∞—Ç–∏ —Ñ—ñ–ª—å–º' : '–î–æ–¥–∞—Ç–∏ —Ñ—ñ–ª—å–º';
  $('#fTitle').value   = m?.title   ?? '';
  $('#fYear').value    = m?.year    ?? '';
  $('#fGenre').value   = m?.genre   ?? '';
  $('#fRating').value  = m?.rating  ?? 0;
  $('#fPoster').value  = m?.poster_url ?? '';
  $('#fComment').value = m?.comment ?? '';
  $('#fWatched').checked = !!m?.watched;
  $('#modal').classList.add('show');
  document.body.style.overflow = 'hidden';
}
function closeModal(){ $('#modal').classList.remove('show'); document.body.style.overflow = ''; }

function openMini(movie){
  markTarget = movie;
  $('#mwRating').value = movie?.rating ?? 5;
  $('#mwComment').value = movie?.comment ?? '';
  $('#mini').classList.add('show'); document.body.style.overflow='hidden';
}
function closeMini(){ $('#mini').classList.remove('show'); document.body.style.overflow=''; markTarget=null; }

$('#addBtn').onclick = ()=>openModal();
$('#cancel').onclick = closeModal;
$('#q').oninput = ()=>render();
$('#mwCancel').onclick = closeMini;
$('#mwOk').onclick = async ()=>{
  const r = Number($('#mwRating').value||0);
  const c = $('#mwComment').value.trim();
  if (!markTarget) return closeMini();
  await fetchJSON(`${API}/${markTarget.id}`,{
    method:'PUT',
    body: JSON.stringify({ watched:true, rating: Math.max(0,Math.min(5,Math.round(r))), comment:c })
  });
  closeMini(); toast('–ü–æ–∑–Ω–∞—á–µ–Ω–æ —è–∫ –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç–æ'); render(); loadFavs();
};

$('#save').onclick = async ()=>{
  const body = {
    title: $('#fTitle').value.trim(),
    year: $('#fYear').value ? Number($('#fYear').value) : null,
    genre: $('#fGenre').value.trim(),
    rating: Number($('#fRating').value)||0,
    comment: $('#fComment').value.trim(),
    watched: $('#fWatched').checked,
    poster_url: $('#fPoster').value.trim() || null,
    director: $('#fDirector').value.trim(),  // part b
    release_date: $('#fReleaseDate').value.trim()  // part b
  };
  if (editing) await fetchJSON(`${API}/${editing.id}`, { method:'PUT', body: JSON.stringify(body) });
  else await fetchJSON(API, { method:'POST', body: JSON.stringify(body) });
  closeModal(); toast('–ó–±–µ—Ä–µ–∂–µ–Ω–æ'); render(); loadFavs();
};

function heart(isFav){ return isFav ? '‚ô•' : '‚ô°'; }

function drawList(items, target) {
  target.innerHTML = '';
  if (!items.length) { target.innerHTML = '<div class="empty">–ù—ñ—á–æ–≥–æ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ</div>'; return; }
  items.forEach(m => {
    const el = document.createElement('article'); el.className = 'movie' + (m.watched ? ' watched' : '');
    const poster = m.poster_url || placeholder;
    el.innerHTML = `
      <img class="poster" src="${poster}" alt="poster">
      <div>
        <div class="title">${m.title}</div>
        <div class="meta">üé• ${[m.genre || '–ë–µ–∑ –∂–∞–Ω—Ä—É', m.year || '‚Äî'].filter(Boolean).join(' ‚Ä¢ ')}</div>
        <div class="meta">${m.comment ? ('–ö–æ–º–µ–Ω—Ç–∞—Ä: ' + m.comment) : ''}</div>
        ${m.genre ? '<div class="chip">' + m.genre + '</div>' : ''}
        <!-- Part B: –î–æ–¥–∞—î–º–æ —Ä–µ–∂–∏—Å–µ—Ä–∞ -->
        <div class="meta">–†–µ–∂–∏—Å–µ—Ä: ${m.director || '–ù–µ–≤—ñ–¥–æ–º–∏–π'}</div> 
        <!-- Part B: –î–æ–¥–∞—î–º–æ –¥–∞—Ç—É –≤–∏—Ö–æ–¥—É -->
        <div class="meta">–î–∞—Ç–∞ –≤–∏—Ö–æ–¥—É: ${m.release_date || '–ù–µ–≤—ñ–¥–æ–º–∞'}</div>
      </div>
      <div style="display:flex;gap:8px;align-items:center">
        <div class="stars" title="–û—Ü—ñ–Ω–∏—Ç–∏">${starString(m.rating || 0)}</div>
        <button class="btn" data-toggle>${m.watched ? '‚Ü©Ô∏é –í –ø–ª–∞–Ω' : '‚úî –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–æ'}</button>
        <button class="btn" data-edt>‚úé</button>
        <button class="btn" data-del>üóë</button>
        <button class="heart ${m.favorite ? 'fav' : ''}" data-fav>${heart(m.favorite)}</button>
      </div>`;
    
    // delete
    el.querySelector('[data-del]').onclick = async () => {
      if (confirm('–í–∏–¥–∞–ª–∏—Ç–∏?')) { await fetchJSON(`${API}/${m.id}`, { method: 'DELETE' }); render(); loadFavs(); }
    };
    // edit
    el.querySelector('[data-edt]').onclick = () => openModal(m);
    // watched toggle
    el.querySelector('[data-toggle]').onclick = async () => {
      if (!m.watched) { openMini(m); }
      else {
        await fetchJSON(`${API}/${m.id}`, {
          method: 'PUT', body: JSON.stringify({ watched: false })
        });
        toast('–ü–æ–≤–µ—Ä–Ω–µ–Ω–æ —É –ø–ª–∞–Ω'); render(); loadFavs();
      }
    };
    // rate
    el.querySelector('.stars').onclick = async () => {
      const v = Number(prompt('–û—Ü—ñ–Ω–∫–∞ 0‚Äì5', m.rating || 0));
      if (Number.isFinite(v) && v >= 0 && v <= 5) {
        await fetchJSON(`${API}/${m.id}`, { method: 'PUT', body: JSON.stringify({ rating: Math.round(v) }) });
        render();
      }
    };
    // favorite
    el.querySelector('[data-fav]').onclick = async () => {
      await fetchJSON(`${API}/${m.id}/favorite`, {
        method: 'PUT',
        body: JSON.stringify({ favorite: !m.favorite })
      });
      render(); loadFavs();
    };
    target.appendChild(el);
  });
}
  
async function refreshSummary(){
  const all = await fetchJSON(API); // –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –í–°–Ü —Ñ—ñ–ª—å–º–∏ –¥–ª—è –ø—ñ–¥—Ä–∞—Ö—É–Ω–∫—É
  const plans = all.filter(m=>!m.watched).length;
  const seen = all.filter(m=>m.watched).length;
  $('#summary').textContent = `üéû –£ –ø–ª–∞–Ω–∞—Ö: ${plans} | ‚úÖ –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–æ: ${seen}`;
}

const tmdbBox = document.getElementById('tmdbResults');
const tmdbTitle = document.getElementById('tmdbTitle');

function drawTmdb(results){
  if (!results.length){ tmdbBox.style.display='none'; tmdbTitle.style.display='none'; tmdbBox.innerHTML=''; return; }
  tmdbTitle.style.display = '';
  tmdbBox.style.display = '';
  tmdbBox.innerHTML = '';
  results.forEach(m=>{
    const el = document.createElement('article'); el.className='movie';
    const poster = m.poster_url || 'https://placehold.co/200x300?text=TMDB';
    el.innerHTML = `
      <img class="poster" src="${poster}" alt="">
      <div>
        <div class="title">${m.title}</div>
        <div class="meta">${m.year || '‚Äî'}</div>
      </div>
      <div style="display:flex;gap:8px;align-items:center">
        <button class="btn" data-plan>+ –£ –ø–ª–∞–Ω</button>
        <button class="btn primary" data-fav>‚òÖ –î–æ —É–ª—é–±–ª–µ–Ω–∏—Ö</button>
      </div>`;
    el.querySelector('[data-plan]').onclick = async ()=>{
      await fetch('/api/tmdb/add', {
        method:'POST', headers:{'Content-Type':'application/json'},
        body: JSON.stringify({ tmdb_id: m.tmdb_id, watched: false, favorite: false })
      });
      toast('–î–æ–¥–∞–Ω–æ –≤ –ø–ª–∞–Ω'); render(); loadFavs();
    };
    el.querySelector('[data-fav]').onclick = async ()=>{
      await fetch('/api/tmdb/add', {
        method:'POST', headers:{'Content-Type':'application/json'},
        body: JSON.stringify({ tmdb_id: m.tmdb_id, watched: false, favorite: true })
      });
      toast('–î–æ–¥–∞–Ω–æ –¥–æ —É–ª—é–±–ª–µ–Ω–∏—Ö'); render(); loadFavs();
    };
    tmdbBox.appendChild(el);
  });
}

async function searchTmdb(q){
  if (!q || q.length < 2) { tmdbBox.style.display='none'; tmdbTitle.style.display='none'; tmdbBox.innerHTML=''; return; }
  const res = await fetch(`/api/tmdb/search?q=${encodeURIComponent(q)}`).then(r=>r.json());
  tmdbTitle.style.display=''; tmdbBox.style.display='';
  drawTmdb(res);
}

// *** –í–ò–ü–†–ê–í–õ–ï–ù–ê –§–£–ù–ö–¶–Ü–Ø RENDER ***
async function render(){
  const q = $('#q').value.trim();
  // 1. –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –í–°–Ü —Ñ—ñ–ª—å–º–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, –Ω–µ–∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ –ø–æ—à—É–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Ç—É
  const allItems = await fetchJSON(API);

  // 2. –§—ñ–ª—å—Ç—Ä—É—î–º–æ –ª–∏—à–µ –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —É –∫–æ–ª–æ–Ω–∫–∞—Ö "–•–æ—á—É –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏" —Ç–∞ "–ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–æ"
  drawList(allItems.filter(m=>!m.watched), todo);
  drawList(allItems.filter(m=>m.watched),  done);

  // 3. –û–Ω–æ–≤–ª—é—î–º–æ –ø—ñ–¥—Å—É–º–æ–∫ (refreshSummary —Ç–µ–ø–µ—Ä —Ä–æ–±–∏—Ç—å —Ü–µ —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ)
  refreshSummary();
  
  // 4. –ü–æ—à—É–∫ —É TMDB (—Ü–µ–π –ø–æ—à—É–∫ –º–∞—î –±—É—Ç–∏ –ª–∏—à–µ –¥–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è, —Ç–æ–º—É query –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Ç—É—Ç)
  searchTmdb(q);
}
// *** –ö–Ü–ù–ï–¶–¨ –í–ò–ü–†–ê–í–õ–ï–ù–û–á –§–£–ù–ö–¶–Ü–á RENDER ***

async function loadFavs(){
  const items = await fetchJSON(`${API}/favorites`);
  drawList(items, favs);
}

render(); loadFavs();
</script>
</body>
</html>
